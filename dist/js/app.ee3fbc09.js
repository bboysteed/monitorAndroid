(function(e){function t(t){for(var a,i,n=t[0],l=t[1],c=t[2],u=0,m=[];u<n.length;u++)i=n[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);p&&p(t);while(m.length)m.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,n=1;n<s.length;n++){var l=s[n];0!==o[l]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=s[0]))}return e}var a={},o={app:0},r=[];function i(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=a,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var p=l;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("el-tabs",{staticClass:"tabclass",attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"first"}},[s("span",{staticStyle:{"font-size":"15px","font-weight":"bold"},attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-edit-outline",staticStyle:{"font-size":"25px"}}),e._v(" 任务发布")]),s("charts")],1),s("el-tab-pane",{attrs:{name:"second"}},[s("span",{staticStyle:{"font-size":"15px","font-weight":"bold"},attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-document",staticStyle:{"font-size":"25px"}}),e._v(" 日志查看")]),s("LogViewComponent")],1)],1)],1)},r=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[s("el-col",{attrs:{span:18}},[s("div",{style:{width:"1400px",height:"400px"},attrs:{id:"cpu"}}),s("p"),s("div",{style:{width:"1400px",height:"400px"},attrs:{id:"ram"}})]),s("el-col",{attrs:{span:6}},[s("missionForm")],1)],1)],1)},n=[],l=(s("ac1f"),s("1276"),s("313e")),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",{staticStyle:{"margin-left":"20px"},attrs:{shadow:"hover"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"font-size":"15px","font-weight":"bold"}},[e._v("任务创建")]),s("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.formTips}},[e._v("填写说明")]),s("el-drawer",{attrs:{title:"填写说明",visible:e.drawer,direction:"rtl"},on:{"update:visible":function(t){e.drawer=t}}},[s("span",[e._v("填写说明")])])],1),s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"测试名称",prop:"missionName"}},[s("el-input",{model:{value:e.ruleForm.missionName,callback:function(t){e.$set(e.ruleForm,"missionName",t)},expression:"ruleForm.missionName"}})],1),s("el-form-item",{attrs:{label:"被测app",prop:"apps"}},[s("el-select",{staticStyle:{width:"300px"},attrs:{multiple:"",placeholder:"请选择要测试的app",size:"medium",clearable:""},model:{value:e.ruleForm.apps,callback:function(t){e.$set(e.ruleForm,"apps",t)},expression:"ruleForm.apps"}},e._l(e.apps,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",{attrs:{label:"测试线程"}},[s("el-input-number",{attrs:{min:1,max:100,label:"测试线程",step:1,size:"small","step-strictly":""},model:{value:e.ruleForm.thread,callback:function(t){e.$set(e.ruleForm,"thread",t)},expression:"ruleForm.thread"}}),s("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"数字越大代表测试流量越大，系统越容易出问题"}},[s("el-tag",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",size:"small",type:"warning",effect:"plain"},slot:"reference"},[e._v("输入1-100的数字 ")])],1)],1),s("el-form-item",{attrs:{label:"随机事件数"}},[s("el-input-number",{attrs:{min:10,max:2e4,label:"测试线程",step:10,size:"small","step-strictly":""},model:{value:e.ruleForm.operaNums,callback:function(t){e.$set(e.ruleForm,"operaNums",t)},expression:"ruleForm.operaNums"}}),s("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"数字越大代表每次测试的随机事件越多测试时长越长"}},[s("el-tag",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",size:"small",type:"warning",effect:"plain"},slot:"reference"},[e._v("输入10-20000的数字 ")])],1)],1),s("el-form-item",{attrs:{label:"操作间隔(ms)"}},[s("el-input-number",{attrs:{min:300,max:3e3,label:"测试线程",step:100,size:"small","step-strictly":""},model:{value:e.ruleForm.throehold,callback:function(t){e.$set(e.ruleForm,"throehold",t)},expression:"ruleForm.throehold"}}),s("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"数字越大，代表模拟操作越频繁"}},[s("el-tag",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",size:"small",type:"warning",effect:"plain"},slot:"reference"},[e._v(" 输入300-3000的数字 ")])],1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),s("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1),s("p"),s("el-card",{staticClass:"box-card",staticStyle:{"margin-left":"20px","margin-top":"10px"},attrs:{shadow:"hover"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"font-size":"15px","font-weight":"bold"}},[e._v("任务详情")]),s("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text"},on:{click:e.showMissionsDetile}},[e._v("进度")]),s("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.clearAllMissions}},[e._v("清除任务")])],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.missions}},[s("el-table-column",{attrs:{prop:"id",label:"序号",width:"50"}}),s("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"130"}}),s("el-table-column",{attrs:{prop:"startTime",label:"开始时间",width:"130"}}),s("el-table-column",{attrs:{prop:"state",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{staticStyle:{width:"60px","text-align":"center"},attrs:{effect:"dark",type:e.stateType,"disable-transitions":""}},[e._v(e._s(t.row.state)+" ")])]}}])})],1)],1),s("el-dialog",{attrs:{title:"任务详情",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[s("el-table",{attrs:{data:e.missions}},[s("el-table-column",{attrs:{property:"id",label:"序号",width:"100"}}),s("el-table-column",{attrs:{property:"name",label:"任务名称",width:"200"}}),s("el-table-column",{attrs:{property:"startTime",label:"开始时间",width:"200"}}),s("el-table-column",{attrs:{property:"progress",label:"进度",width:"100"}}),s("el-table-column",{attrs:{property:"sum",label:"总数",width:"100"}}),s("el-table-column",{attrs:{property:"state",label:"状态"}})],1)],1)],1)},p=[],u={name:"missionForm",data:function(){return{drawer:!1,dialogTableVisible:!1,tableLoading:"",wspath:"ws://"+window.location.href.split("//")[1].split(":")[0]+":8089/missionStatews",socket:"",stateType:"warning",androidID:"",apps:[],ruleForm:{missionName:"",apps:[],thread:"10",operaNums:"100",throehold:"1000"},missions:[],rules:{missionName:[{required:!0,message:"请输入测试名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"change"}],apps:[{required:!0,message:"请选择测试apps",trigger:"blur"}]}}},created:function(){this.getAppList()},methods:{showMissionsDetile:function(){this.dialogTableVisible=!0},submitForm:function(e){var t=this;1!==this.missions.length?this.$refs[e].validate((function(e){if(!e)return t.$message.error("请检查参数！"),!1;t.tableLoading=!0,console.log(t.ruleForm);var s={name:t.ruleForm.missionName,apps:t.ruleForm.apps,thread:t.ruleForm.thread,operanums:t.ruleForm.operaNums,interval:t.ruleForm.throehold};t.$axios.post("/commitMission",JSON.stringify(s)).then((function(e){console.log(e),"running"!==e.data.msg?(t.$message.success("提交成功！"),t.missions.push({id:1,name:t.ruleForm.missionName,state:"",startTime:"",progress:0,sum:t.ruleForm.thread*t.ruleForm.apps.length,deviceoffline:!1}),t.startWs()):t.$message.warning("上一任务未结束！")})).catch((function(e){console.log(e)}))})):this.$message.warning("单任务系统！")},resetForm:function(e){this.ruleForm.thread=10,this.ruleForm.throehold=1e3,this.$refs[e].resetFields()},formTips:function(){this.drawer=!0},clearAllMissions:function(){"running"!==this.missions[0].state?this.missions=[]:this.$message.warning("当前任务未结束!")},startWs:function(){"undefined"===typeof WebSocket?this.$message.error("您的浏览器不支持socket"):(this.socket=new WebSocket(this.wspath),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage)},open:function(){console.log("socket2连接成功")},error:function(){console.log("连接错误")},getMessage:function(e){var t=JSON.parse(e.data);if(t.deviceoffline)return this.stateType="error",this.missions[0].state="offline",void this.$message({message:"设备掉线！",type:"error",duration:0,showClose:!0});this.missions[0].progress=t.progress,this.missions[0].state=t.state,this.missions[0].startTime=t.startTime,"finished"===t.state?(this.stateType="success",this.$message({message:"测试完毕！",type:"success",showClose:!0,duration:1e4})):this.stateType="warning",this.tableLoading=!1},send:function(){this.socket.send(this.ruleForm)},close:function(){console.log("socket已经关闭")},getAppList:function(){var e=this;this.$axios.get("/getAppList").then((function(t){if(console.log(t),"offline"!==t.data.msg){e.$message.success("连接成功！");var s=t.data.packages;e.androidID=t.data.androidID;for(var a=0;a<s.length;a++)e.apps.push({label:s[a],value:s[a]})}else e.$message.error("设备掉线")})).catch((function(t){console.log(t),e.$message.error("连接后台失败，请刷新页面")}))}}},m=u,d=s("2877"),h=Object(d["a"])(m,c,p,!1,null,"dcad5ad0",null),f=h.exports,g={components:{missionForm:f},data:function(){return{loading:"",wspath:"ws://"+window.location.href.split("//")[1].split(":")[0]+":8089/ws",socket:"",cpuData:[],cpuTemperatureData:[],ramData:[],date:[]}},mounted:function(){this.loading=this.$loading({lock:!0,text:"正在连接...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),console.log(this.$store.state.apis),console.log(this.wspath),this.initWS(),this.initChart()},methods:{initWS:function(){"undefined"===typeof WebSocket?alert("您的浏览器不支持socket"):(this.socket=new WebSocket(this.wspath),this.socket.onopen=this.open,this.socket.onerror=this.error,this.socket.onmessage=this.getMessage)},open:function(){console.log("socket1连接成功"),this.loading.close()},error:function(){console.log("连接错误")},getMessage:function(e){var t=JSON.parse(e.data);if("offline"!==t.msg){this.date.push((new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString());var s=JSON.parse(e.data);this.cpuData.push(s.cpuInfo.all_rate),this.ramData.push(s.ramInfo.rate),this.cpuTemperatureData.push(s.cpuInfo.temperature),this.cpuChart.setOption({xAxis:{data:this.date},series:[{name:"cpu使用率",data:this.cpuData},{name:"cpu温度",data:this.cpuTemperatureData}]}),this.ramChart.setOption({xAxis:{data:this.date},series:{name:"ram使用率",data:this.ramData}})}else this.$message({showClose:!0,message:"设备掉线",duration:0,type:"error",offset:40})},send:function(){this.socket.send()},close:function(){console.log("socket已经关闭")},initChart:function(){this.cpuChart=l["a"](document.getElementById("cpu"),"dark"),this.ramChart=l["a"](document.getElementById("ram"),"dark"),this.cpuChart.setOption({title:{text:"cpu使用信息"},tooltip:{trigger:"axis",axisPointer:{animation:!1}},legend:{data:["cpu使用率","cpu温度"]},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{},toolbox:{right:10,feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},dataZoom:[{type:"inside"}],visualMap:{top:50,right:10,pieces:[{gt:0,lte:50,color:"#93CE07"},{gt:50,lte:80,color:"#FC7D02"},{gt:80,lte:100,color:"#FD0100"}],outOfRange:{color:"#999"}},series:[{name:"cpu使用率",type:"line",smooth:"true",symbol:"none",data:this.cpuData,markLine:{silent:!0,lineStyle:{color:"#333"},data:[{yAxis:90}]}},{name:"cpu温度",type:"line",smooth:"true",symbol:"none",data:this.cpuTemperatureData}]}),this.ramChart.setOption({title:{text:"ram使用信息"},tooltip:{trigger:"axis",axisPointer:{animation:!1}},legend:{data:["ram使用率"]},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{},toolbox:{right:10,feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},dataZoom:[{type:"inside"}],visualMap:{top:50,right:10,pieces:[{gt:0,lte:50,color:"#93CE07"},{gt:50,lte:80,color:"#FC7D02"},{gt:80,lte:100,color:"#FD0100"}],outOfRange:{color:"#999"}},series:[{name:"ram使用率",type:"line",smooth:"true",symbol:"none",stack:"a",areaStyle:{normal:{}},data:this.ramData}]})}},destroyed:function(){this.socket.onclose=this.close}},b=g,y=Object(d["a"])(b,i,n,!1,null,"046a3d8f",null),v=y.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._v("log")])},w=[],k={name:"LogViewComponent"},F=k,S=Object(d["a"])(F,x,w,!1,null,"54561d24",null),_=S.exports,D={name:"App",components:{Charts:v,LogViewComponent:_},data:function(){return{activeName:"first"}},methods:{handleClick:function(e,t){console.log(e,t)}}},$=D,C=(s("034f"),Object(d["a"])($,o,r,!1,null,null,null)),O=C.exports,N=s("bc3a"),T=s.n(N),A=s("4328"),I=s.n(A),L=s("5c96"),M=s.n(L),j=(s("0fae"),s("2f62"));a["default"].use(j["a"]);var z={apis:[],androidID:""},E={get_apis:function(e){return e.apis},getAndroidID:function(e){return e.androidID}},P={set_apis:function(e,t){e.apis=t},setAndroidID:function(e,t){e.androidID=t}},V=new j["a"].Store({getters:E,state:z,mutations:P});a["default"].prototype.$axios=T.a,a["default"].prototype.$qs=I.a,a["default"].use(M.a),console.log(Object({NODE_ENV:"production",BASE_URL:"/"})),a["default"].config.productionTip=!1,new a["default"]({store:V,render:function(e){return e(O)}}).$mount("#app")},"85ec":function(e,t,s){}});
//# sourceMappingURL=app.ee3fbc09.js.map